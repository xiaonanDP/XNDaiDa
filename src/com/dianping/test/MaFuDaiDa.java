package com.dianping.test;

import java.awt.*;
import java.awt.event.*;
import java.io.IOException;
import java.net.InetSocketAddress;
import java.nio.ByteBuffer;
import java.nio.channels.SocketChannel;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.Date;
import java.util.GregorianCalendar;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import com.redcdn.test.Customer;
import com.redcdn.test.Server;
import com.redcdn.test.TestAdapter;

public class MaFuDaiDa extends Frame implements ActionListener {

  /**
	 * 
	 */
	private static final long serialVersionUID = 1L;
	Button cutButton;  
	TextField secondText;
	TextField timeText;
	Label label;
	
	Button checkButton;
	TextField passwordText;
	TextField dateText;
	TextArea resultArea; 
	
	static int timeDuration = 0;
	
	List<Customer> iosCustomerList = null;
	Map<String,Server> iosServerMap = null;
	
	List<Customer> freeCustomerList = null;
	Map<String,Server> androidServerMap = null;
	
	static int groupSize = 1;
	static String ACTION_CHECK_SELF = "ACTION_CHECK_SELF";
	static String ACTION_BEGIN = "ACTION_BEGIN";
	
	public MaFuDaiDa() {
		super("MaFu DaiDa");
		
		setSize(500, 280);
		addWindowListener(new TestAdapter());
	  
		Panel toolbar = new Panel();
		toolbar.setLayout(new FlowLayout(FlowLayout.LEFT));

		cutButton = new Button("BEGIN");
		cutButton.setActionCommand(ACTION_BEGIN);
		cutButton.addActionListener(this);
		toolbar.add(cutButton);
	    
	    secondText = new TextField(8);
	    secondText.setText("16");
	    toolbar.add(secondText);
	    
	    label = new Label("second");
	    toolbar.add(label);
	    
	    label = new Label("LanDaCount :      ");
	    toolbar.add(label);
	    
	    timeText = new TextField(6);
	    timeText.setText("61");
	    toolbar.add(timeText);
	    
	    Label label_ = new Label("minutes close.");
	    toolbar.add(label_);
	    
	    add(toolbar, BorderLayout.NORTH);
	    
	    Panel backGround = new Panel();
	    backGround.setLayout(new FlowLayout(FlowLayout.LEFT));
	    checkButton = new Button("check");
	    checkButton.addActionListener(this);
	    checkButton.setActionCommand(ACTION_CHECK_SELF);
	    backGround.add(checkButton);
	    
	    passwordText = new TextField(10);
	    passwordText.setText("");
	    backGround.add(passwordText);
	    
	    dateText = new TextField(10);
	    dateText.setText("");
	    backGround.add(dateText);
	    
	    resultArea = new TextArea(200,300);
	    backGround.add(resultArea);
	    
	    add(backGround, BorderLayout.CENTER);
	    
	    this.startTask();
	}
	
	public static void main(String args[]) {
		  MaFuDaiDa tf1 = new MaFuDaiDa();
		  tf1.setVisible(true);
		  
	  }
	
  static int interval = 0;
  public void actionPerformed(ActionEvent ae) {
      
	if(ae.getActionCommand().equals(ACTION_CHECK_SELF)){
		String password = passwordText.getText();
		String dateStr = dateText.getText();
		if("5188".equals(password)){
//			checkSelf(dateStr);
		}else{
//			checkAll(dateStr);
		}
		
	}else if(ae.getActionCommand().equals(ACTION_BEGIN)){
		this.startTask();
	}else{
		
	}  
	  
  }
  
  private void startTask(){
	  
	  cutButton.setEnabled(false);
	    interval = new Integer( secondText.getText()).intValue();
	    if (interval < 1 || interval > 65)
	      interval = 61;
	    
	    timeDuration = new Integer( timeText.getText()).intValue();
	    if (timeDuration < 10)
	      timeDuration = 30;
	    
	    // init customers
	    initIOSCustomers();
	    initIOSServers();
	    
	    // ios peien
	    for(int i=0 ; i<iosCustomerList.size(); i += groupSize){
	      MyThread m0 = new MyThread(i);
	      new Thread(m0).start();
	      try{
	        Thread.sleep(100);
	      }catch(Exception e){
	        e.printStackTrace();
	      }
	    }
	    
	    // free ios peien
	    for(int i=0 ; i<freeCustomerList.size(); i += groupSize){
	      MyThread m0 = new MyThread(i+1000);
	      new Thread(m0).start();
	      try{
	        Thread.sleep(100);
	      }catch(Exception e){
	        e.printStackTrace();
	      }
	    }
	    
	    System.out.println("...."+interval);
  }
  
  public void doPeiEn(int threadNumber){
	  
	if(checkTime(20,29,60) == 0)
	  return;
	doIOSPeiEn(threadNumber);
    
    if(threadNumber == 0 || threadNumber == 1000){
      label.setText("LanDaCount : "+landaCount);
      
      if(landaCount > 10000){
        landaCount = 0;
      }else{
        landaCount++;
      }
    }
    
  }
	
	static int landaCount = 0;
	
	public void doPeiEn(String host,int port,String loginStr)
  {
      try{
            InetSocketAddress remote = new InetSocketAddress(host, port);  
            SocketChannel sc = SocketChannel.open();  
            sc.connect(remote);  
            
            List<String> cmdList = new ArrayList<String>();
            cmdList.add(loginStr);
            cmdList.add("0000001400020400C8855A17827227F5418585C085BB55E1");
            cmdList.add("0000001400030300AE855A17827227F5418585C085BBA3220000001400040300D6855A17827227F5418585C085BB25E1");
            cmdList.add("0000001400050700C8855A17827227F5418585C085BB55E6");
            cmdList.add("0000002500061C00C8855A17827227CCAA29EB291BF2F87E8FF2C278F28F23D1834185E8BBD628A9D1");
            cmdList.add("0000001400070600AE855A17827227F5418585C085BBA326");
            cmdList.add("0000001400081700C8855A17827227F5418585C085BB55EB0000001400091300C8855A17827227F5418585C085BB55EA00000014000A1A00C8855A17827227F5418585C085BB55E900000014000B14005D855A17827227F5418585C085BB484100000024000C1400C8855A17827227CC3E29EB8FF2291BF23F89F31BB62927274185DB77226430EC00000014000D130022855A17827227F5418585C085BBA84B00000014000E1C005D855A17827227F5418585C085BB484400000014000F1600C8855A17827227F5418585C085BB55EC");
            cmdList.add("0000001400101200C8855A17827227F5418585C085BB55F3");
            cmdList.add("0000001400111B00C8855A17827227F5418585C085BB55F2");
            cmdList.add("0000001400121B00C8855A17827227F5418585C085BB55F1");
            cmdList.add("0000001400131B0076855A17827227F5418585C085BBD853");
            
            if (landaCount == 0) {
              //canzhan
              cmdList.add("0000001C00141B00AE855A1782722742295B29B4D169D7E341859A83763DCFCE");
            }else{
              
              if (interval > 30)
                //canzhan
              cmdList.add("0000001C00141B00AE855A1782722742295B29B4D169D7E341859A83763DCFCE");
              else
                //fuhuo
              cmdList.add("0000001C00141B00AE855A1782722742295B29B4D169D7F541859AF5761FAC89");
            }
            
            for(int j = 0; j< cmdList.size() ; j++){
              String cmdStr = cmdList.get(j);
              ByteBuffer bb = ByteBuffer.wrap(hexStringToByteArray(cmdStr));
              sc.write(bb);
            }
            
            sc.close();
      } catch (IOException e) {  
              e.printStackTrace();  
      }
    
  }
	
	public void doFreePeiEn(String host,int port,String loginStr)
	  {
	      try{
	            InetSocketAddress remote = new InetSocketAddress(host, port);  
	            SocketChannel sc = SocketChannel.open();  
	            sc.connect(remote);  
	            
	            List<String> cmdList = new ArrayList<String>();
	            cmdList.add(loginStr);
	            cmdList.add("0000001400020400C8855A17827227F5418585C085BB55E1");
	            cmdList.add("0000001400030300AE855A17827227F5418585C085BBA3220000001400040300D6855A17827227F5418585C085BB25E1");
	            cmdList.add("0000001400050700C8855A17827227F5418585C085BB55E6");
	            cmdList.add("0000002500061C00C8855A17827227CCAA29EB291BF2F87E8FF2C278F28F23D1834185E8BBD628A9D1");
	            cmdList.add("0000001400070600AE855A17827227F5418585C085BBA326");
	            cmdList.add("0000001400081700C8855A17827227F5418585C085BB55EB0000001400091300C8855A17827227F5418585C085BB55EA00000014000A1A00C8855A17827227F5418585C085BB55E900000014000B14005D855A17827227F5418585C085BB484100000024000C1400C8855A17827227CC3E29EB8FF2291BF23F89F31BB62927274185DB77226430EC00000014000D130022855A17827227F5418585C085BBA84B00000014000E1C005D855A17827227F5418585C085BB484400000014000F1600C8855A17827227F5418585C085BB55EC");
	            cmdList.add("0000001400101200C8855A17827227F5418585C085BB55F3");
	            cmdList.add("0000001400111B00C8855A17827227F5418585C085BB55F2");
	            cmdList.add("0000001400121B00C8855A17827227F5418585C085BB55F1");
	            cmdList.add("0000001400131B0076855A17827227F5418585C085BBD853");
	            //
	            cmdList.add("0000001C00141B00AE855A1782722742295B29B4D169D7E341859A83763DCFCE");
	            
	            for(int j = 0; j< cmdList.size() ; j++){
	              String cmdStr = cmdList.get(j);
	              ByteBuffer bb = ByteBuffer.wrap(hexStringToByteArray(cmdStr));
	              sc.write(bb);
	            }
	            
	            sc.close();
	      } catch (IOException e) {  
	              e.printStackTrace();  
	      }
	    
	  }
	
	
	public byte[] hexStringToByteArray(String s) {
	    int len = s.length();
	    byte[] data = new byte[len / 2];
	    for (int i = 0; i < len; i += 2) {
	        data[i / 2] = (byte) ((Character.digit(s.charAt(i), 16) << 4)
	                             + Character.digit(s.charAt(i+1), 16));
	    }
	    return data;
	}
	
	public static int checkTime(int beginHour,int beginMinute,int duration){
		
	int beginMonth = 11;
	  
    GregorianCalendar currentTime = new GregorianCalendar();
    currentTime.setTime(new Date());
    
//    int month = currentTime.get(Calendar.MONTH)+1;
//    if( month != beginMonth){
//      return 0;
//    }
    
    int hour = currentTime.get(Calendar.HOUR_OF_DAY);
    int minute = currentTime.get(Calendar.MINUTE);
    
    if(hour < beginHour || (hour == beginHour && minute < beginMinute)){
      return 0;
    }
    
    int hours = hour - beginHour;
    int totalMinutes = hours*60 - beginMinute + minute;
    if(totalMinutes < duration){
      return 1;
    }else{
      return 0;
    }
    
  }
	
	class MyThread implements Runnable {
	  
	  private int threadNumber = 0;
	  public int getThreadNumber() {
      return threadNumber;
    }
    public void setThreadNumber(int threadNumber) {
      this.threadNumber = threadNumber;
    }

    public MyThread(int threadNumber){
	    super();
	    this.threadNumber = threadNumber;
	  }
	  
    public void run() {
      
        try {
          do{
            doPeiEn(threadNumber);
            Thread.sleep(threadNumber < 1000?15500:61000);
          }while(true);

        } catch (Exception e) {
            e.printStackTrace();
        }
        
    }
       
	}
	
  /**
   * ===== ======== ===================================== =================================== ===== ios peien
   */

  public List<Customer> initIOSCustomers(){
    
    if(iosCustomerList == null){
    	
      freeCustomerList = new ArrayList<Customer>(10);
      iosCustomerList = new ArrayList<Customer>(10);
      
      freeCustomerList.add(new Customer("xiaonanche",161213,"10","330434980","0000007E0001020076855A1722B02AEBF420A285C6EFBBEBD34E00092D297F7FC53126BBCF51E52AA5CC5C7C93AAE92C184CEED3C26BE56B929DDFA3056CEAAC678F490B95391FA90F518548E3B041A5775C54D20A9B73157474B373132E1154C5FBB7CBDBDFA1054E19C8DA276146EE5791E40F131A96AAE62F721DC00F94720744"));
//      freeCustomerList.add(new Customer("yqazj1314",160603,"15","99849991","0000007E0001020076855A1722B025EBC320A28593EFBB8C7944B0E010367E8CCED5D98664197F902D12E684BF269B5F995923839515C288FE83B545CAD8ADC9E785E3476A0385976E20DAE0D8B56F1E99949CC5B777930E2C73FD63F9121197E1B351B671939D7530B536B2366DF01CC1E07D60AB8A9B40F83D7A22795720A6FBFE"));
//      freeCustomerList.add(new Customer("ly1103mm",160324,"17","105552119","0000007D0001020076855A1722B02AEBF420A22293EFBB8CA7F4BBC20D6F9F29CC75D945C0A81CB193C007DD00269B5F995956E8A73BFC3B53E0B89915DF0F14FCF4207AE02925E48F265E5DC607939741713A45BFE6B7070B9BBE741ED48FB3BD182C6B4A29540496F1B4FE91AE8A2C530B6AF6299C232D86E2EAE32120206FAE"));
//      freeCustomerList.add(new Customer("KingdomDR",160626,"16","939729744","0000007E0001020076855A179AB025EBF420A28593EFBB8CA7E86CC2D2F5647EA79D352D7B7E1CB193C007DD0026A758D3210DFE07BDB59EB50FEC6FE4683CEA0ED82A49F3FA0BE48F26359F8568377493488EDC39A1FBB3B3E9F8E462967517BC3AC0085CDF7440B41689BA02E7522DC43A49DA3F2B31481B2A55850786DA650DA3"));
//      freeCustomerList.add(new Customer("sssssss360",160603,"17","99849991","0000007E0001020076855A1722B02AEBF420A285C6E37E61B5E37E54A519759340D878457F3F1CC3E3CA4C64760838D99C4BBAD1924084FA26349BD1D64819760E977E6E5A419FB02F55F95F9F75230A43A7B338C31995D88E995D383806501F27DFE077654F76366CC096FDD2F0045C368E6F27392E52EC52FD7D08A71A201E4F1C"));
      freeCustomerList.add(new Customer("shihwingkwok",161005,"2","7926804","0000007E0001020076855A179A7AFDEB76DAA28593E3D7FE1AB122BDA5508D1ACC847A56481CE8A53A30EC41929D25CEF3FC914975919FB729980E57EAD3737435D91D8592AE137F4713FDC1946B0A110674A457115121595CFD65C98E49628734714A760D44E07ABBAFC22A66D7FAB643FA6A7D6A759EF9BCE4499415AF947CC57A"));
//      freeCustomerList.add(new Customer("gold98",160502,"12","2937794263","0000007F0001020076855A1722B025EBF420A28593EF8029136C659CE5F5649AEDF9A636C0C67FA25C8F60D96AD592F4709EB1F2F9E7DB3E562B21245EA475BE88718537224048265C30D211C97AF3C751FD384E35CB953A40CB747209183AAD450BD5C83A3C4B839618874743566F3801034CB25B088F9C99155D52AEBD942086775E"));
//      freeCustomerList.add(new Customer("cc199321",160327,"1","714707671","0000007E0001020076855A179ADF2AEBF420A285C6EFBBEBA7B0AE54A5FB314F4A2F997AA241E52AA55107A02A0838D9ED81E73E9587FBFCFBAF9B88DB9907C214DA8911063D050674A4E972C8C6FD7F7EB0223886D16A499E586B19ACA71B0B3AD0AC636926306D3FE2CF7A0020AE71A32F225D83DA96AAB6BA9BAE23F3940A87D7"));
//      freeCustomerList.add(new Customer("xiangxinwofei3",160424,"17","108134607","0000007E0001020076855A1722B02AEBF420A285C6EF803D17C34591E5F50D2425E4E95F3A22803D981C11825D55301444279C4CCC4D21B6434CA6E843ACF9E9F485C6EB0487FA51C682169748270B9BBE741ED41D27AAAA966B4AA6B298C90A370A2D5EDA2A1DBB5E52C67D1BCE93C93A8AB523A784826A6BB8D094F11E946F53E9"));
//      freeCustomerList.add(new Customer("lws11112",160424,"17","313663305","000000800001020076855A179ADF25EBF420A28593EF802917B1459CD8B6A5551775D94537B07FA21046DE84C6DF0E2CFF525923878F542388F516044C84FA2634A387C8C696B4AEEB65CC1386D92E7964BBABFBFD947A7353D070355F15460F5C75FB280FC222658717932D647C4D69C063CB5F215F33DFD7A0995EB5AE31F1207809DA"));
      freeCustomerList.add(new Customer("18373425889",160930,"14","81738455","0000007F0001020076855A179A9525EBF420A28593EF80291797659CE5F564EB29E42B7B481CB193165BEC41929D25CE5115C90D25C91D32E769BD2D1108174E659F852300ED20C8DABBFA937B8CA49B1894B3594D2B214D133D9FE28860B6276CC43677194A55C1E6DE198B91B570E212A192CEBECE34BCD3A384311D951520FE39C6"));
      //      freeCustomerList.add(new Customer("q982064598",160427,"14","105552119","0000007E0001020076855A179AA12AEBF420A285C6E37E61D7D2AE54A5194F86B0D878453765E52AA55107A000149B6CDB264BBAD1844053FA26349B86D6485085D9EE64AC186F8C89420926A590A97E46B3FAAD21E70B396293590DFF60F902C9F1C2057E035FF23F3C8E04B676FBC48734F665DFFA2952AA70BF88B76B94CEBC76"));
//      freeCustomerList.add(new Customer("lws_11111",160623,"17","2121864142","0000007D0001020076855A1722B02A0CF4A5A28537765861B520F009471A3877B50625F5B7AFEE9F35F0A8725D55301444279C36CF14FCF5809EEEDF112F40A75885372037D6A8485EEBBB933AAB13FFD0840BF7C3ABBC3AB4081017FDA1E273805B189B73409ADA12BA60CF16BC29AF62B59DB50F386A6BB83E948D8D20AB63C5"));
//      freeCustomerList.add(new Customer("djr19950411",160622,"16","1042039767","0000007D0001020076855A1722B025EBF420FE2293EF807E17007730E5426F74317BF345CC2F0D20BB8F60F3443AAFF4289EB1F2F9E779144BFDA3A217739F15A28511EF412C75BFB8458CA26DFC84C7CC34A3EEB56F43883DE4ECABF62ECAF3B9C277F077260D4606202AE97913242BE49B0906705F8A545436DC6E3794503234"));
      freeCustomerList.add(new Customer("312002002",160928,"17","175787776","0000007E0001020076855A179ADF2A0CF4A5A28537765861B520F009471AA4E6C72F9997E81A0A3D1695D7E27C4E186B98C2FFE9B07E6FAF5C74692389FB0673102141854741CB9600F150777E5ED3AFB7E930F26283FD24BDAC2BA7C0F724BB89F612DAFA6C115F783620D378362C4919A78B78D274921AAA7087887AC994C2A6CB"));
//      freeCustomerList.add(new Customer("a199622",160601,"16","455184566","0000007E0001020076855A1722B02A0CE520A28537984EDAE0664EFD0C1A2BAF044578468E338C1DD0E316CE5DE919888BE76BBFD6A3665C0E753634DF1A66B9D59912859347CEA2B02F35E6E3D6741598BBDF0AE681368492E066D83292306EC6487DD9843CE083256712F16696747FF5AD5B8A4CAC7281521AF80872E920D1D3FB"));
//      freeCustomerList.add(new Customer("lovewang1",161025,"16","245795286","0000007F0001020076855A179A7A25EBF420A28593EF802917B1779CE5F5BFA0F44035BBBBA81CB1E3A84C5A76783858D3F2FC9149B1FCC3B7297A46DAB5D89AC9EC854E9A4A8AC1C8309D00EB34E43908E94321B6A6A79BFC40CB2D42D0DB6CE7AFEFD287E01EDA524E5D974775CECE0A4C23559699D002FF9918ECAE95A7205E64F2"));
//      freeCustomerList.add(new Customer("199019918",160911,"8","373132213","0000007D0001020076855A1722B02A0CF4A5A285377658B4746AEF0947AB3E2760AC7C960B798FEB77581BA16564FB088D36CB50A60821B64A367311F874F9B57A85C647E7AE2AC6193CD5AC570B7D6D1728F2AD4451888CF97405747547D5A5A656D34929302DFEC2004B4C6152D433A8A7FAA7F6268D52FD2D08B06C94524CBC"));
//    freeCustomerList.add(new Customer("zbx5953607",160315,"6","790592995","0000007D0001020076855A1722B02AEBF420A285C6E37E61B54E00092D29DFD5CFAC7C4085AF7E9FB0C017D322889D67CBE73E95A00E74247313D009D685BA7F53765F96D5A9F686F628D3CB46A963E02421EBFF4551C9D0CBB53FE9B04E91670449D4EFCBBD58C442B4DA754166413AA608CF6DC5C96BDC66E9AEB7FD204B9944"));
//      freeCustomerList.add(new Customer("Q897334654",160701,"16","1085038637","0000007D0001020076855A179AF4730C76DAA285C098A12F332F76AA1236CBDE0618D92C055D08402DA9D86CED193F732F5978074654DA89340765050651A4E9C685C68C6A9847D3940F1F503E05E9D82F17E684361354F2031B324D3C5A141F22EE74BC46A27F6350E4137913274427F26F01575BC9E9A070069FA85594E2868F"));
//      freeCustomerList.add(new Customer("pixxxeee",160625,"17","2902917179","0000007E0001020076855A1722B025EBF420A28593E37E63AD0D7EBDA5508DE7F675D945C6BF0DDA80CC5C674ED12198541B3AC00B686DD78F7D6FE885375CEF8512801369561A06E0EABA1D35A28AEF11AB38EF9FB32E189A6954FBFC47555FF2788CFF0E6E42290BEEBA543CAC678EF8F270098170F4F1545429DC36A2944C009E"));
      freeCustomerList.add(new Customer("13375968652",160925,"17","327467848","0000007E0001020076855A1722B025EBF420A28593EF802917B1459CE5F5BBBBCF25678364D07FA236CC5C674ED12198543E63E19518442DB1C07881AA4D07686F7285C6DA4A9F5CB4D8D4386D9D9CE88F6B4A7123076D2F8C8EB0D4FC765C32FCA2C746E966509183D7DBD196A4C85E7DB5F454F470108A545429DC3B68200186B0"));
//      freeCustomerList.add(new Customer("19901990",160727,"16","175787776","0000007F0001020076855A179A8E25EBF420A28593EF802917B1779CD8B6A5F2D829E42B8DE7BB8CC47B4CD341929D25CE5121895F6C9421397349355D7B8175DF508548A266D2485DDC683463132113FF9D840B0AC3176FD86E9959F6245A1BB020A1CFD2E95D17D0AEB1224969766F7E0782B59EADAA8964A0AA729F368120B93AB0"));
//      freeCustomerList.add(new Customer("ppiiooYY",160829,"17","912730740","0000007E0001020076855A1722B025EBF420A28593EF802917B1459CE5F52764B9F6847AA5379A5DB0C007DD00269B5F99597883B614D2E5297A467A3103DB42A1C8483C375D985C6D484A3BF8D09253DE56D818C925E6A84A0F02D5A17FDA45E72A13E0D5EC9D74B3BDDCC26B9240D36BB8D07D2418A475BEE02B08B61B2009292C"));
      freeCustomerList.add(new Customer("Legogooi",160928,"11","1627665277","0000007E0001020076855A179A7A1A9AF4A5A285C04BDA65892A8DE0964FC408CDB6EECE57392065310A82BF16C6D529C86D5AB873ADFAC5BE1301FB70C885F447C3AE559420E8D3C3E757668FB81165833F74AFE9F524D3364CB501E953A1DA5A8EA644CD76C999899CC05AD6CD471E87595B685B2F8014087CD888F92920E5F80E"));
      freeCustomerList.add(new Customer("疯少",161018,"16","1366332529","0000007F0001020076855A179A0F250CF4A5A285C0765863AD7BEF284735AA973AD3EEF0238AF0B12B1605EC41929D25CE519989116C151A42735B71770774A7E9FEC820DB7F474AE4482549C10267862F9D257D0EA55139623B090DFFC5A59FE1408FDADB38B6FACEBD5D7A422BF93D291060C5A157F3DF6AA353D01D7A52949B6635"));
//      freeCustomerList.add(new Customer("lws11111",160910,"17","749813294","0000007C0001020076855A1722B01B0CF4A5A2D6C0765863ADDAF02847B27A554C75D90ACB4BEE5D6CA605EC41929D2564FC9143D44DD88AFB5B7183AF741FE9FE85415D6F49ADB34247F390105E68AAD78F7D0E0251C94C80B53FE90649F202C219A142F2EEE849816A501278000DD7F968F924F08A545443DC243894FA0010"));

      
//      iosCustomerList.add(new Customer("my79777",160621,"4","774748575","0000007F0001020076855A179A7A25EBF420A28593E35C8CA7F422BDA5508D5E79D3EED60D07E1473ECC5C674ED1219899A1A4D97BD7AFAA9D257D6F72C8C60B375D343C79EAB0360D8B09BDCB0C890346B3D8ADC91174C94C311D77C93E48A234A5D730D2FD91784BCDE102F9E00AECBBD0235596992EDDA099C364C8D20894548653"));
//      iosCustomerList.add(new Customer("243137286",160525,"16","245795286","0000007D0001020076855A1722B02AEBF420A285C6EF803D17C37791E5F5FBF65F03997A30D1453D41715BEC22889D67CBE778070AAACEDDF3D19221E4AB90FA06DF0C85F3C458203800910945984472C70BAC1F0E0274C9B953AC65FF2E9C2BEF93C948FD0523D2C97A2DA219A6270BADF968F924F0A8545430DC17DA20018DED"));
//    iosCustomerList.add(new Customer("sssssss360",160225,"16","790592995","0000007E0001020076855A1722B02AEBF420A285C6EF803D17C37791E5F526E8252F997A293883CB471C11825D55301444279C4CEE14FC4AB90697369B904F7C8C85E129BFAC7A487DAC44A291C9B3E930E4628B9F3ABDAC7B8880D2623E63CB16345FD4AC3F76A84BCBD5B8C960AD5D2726B5F6ADDF708D52FD7D083B88206DE482"));
//      iosCustomerList.add(new Customer("fb_10204367214171254",160511,"12","913533739","0000007E0001020076855A1722B02AEBF420A285C6EF803D136C1D91E5F5199693D878457F291CC3E390DE99C6AAE92C189ED429554BE436E89CAE73FD06EF655D858C2AA46A7F009D8C73FD6D9221E4AB90FA95A6A7C573E5CBDBDF519E879CAE67CEC34F820772D62B027543EC950A4CC26B3E6B9240D36BB87A94ABB520BD2D07"));
//      iosCustomerList.add(new Customer("lws99993",160317,"17","1327864079","0000007E0001020076855A1722B0250CF4A5A285C0765863ADDAF028FE77F7E7B83FE42B164DB48C77F0A8722C9187788D7482CFA8D3A71BBA75361AD05EA7398CE46C85EFAE63C68CF2BF284887785FE8E48F62C319BC3AB4081340099424223C40D5025260C58C8B67AF22ADF6B4912DE4B367072F3D61B2C9BEEA317520E7A115"));
//      iosCustomerList.add(new Customer("19980501",160418,"17","187135206","0000007D0001020076855A1722B02A0CF4A5A28537765861B520F009471A893ACFAC7C9686D5B4EB77D51BA16564FB088D36912DD44D71B787567486EAB573743A65D685B548C8B0E75F41791E426746BD88660DD92462AC2582C0F75990B422AEA36E5729A48CF0486E7B7A3756503B3FE98C216202FFEA18BC9F8E9F942E199B"));
      //      iosCustomerList.add(new Customer("adrianye",160612,"11","891639902","0000007D0001020076855A1722B0B09A76DAA285C6EFCD5A3D1D944C0DD504574767F34548E35A47272FE734E33AD78D36F8980114B689E272FE2853AC146F0485C6DABB5D8C1F5FD6EEEADA6B72EC3D3A603F652124AC2FBC4E966DFE3545E0B9E6BF870D717C6CD6543CC896119B0E78553FA00B70C55205721D7AAA94C2AC16"));
//      iosCustomerList.add(new Customer("zbx5953606",160522,"10","187135206","0000007E0001020076855A179AF11A9AF4A5A285C0FB32CDCB22B1BD37DBEA573D583520EAEB4276A4E0EB8376F63E5F8DA9673E839E54CE2A2C7BB221211790FA95E7768513A563C89F8EF2FC6CC884E88FC77D71230EF2AA5C8E9DFBFC555898557F0F41EB1BDC65C74125ED60E0776F0EC5DC8D8878C9E9A78F3D179A2090A9D1"));
//      iosCustomerList.add(new Customer("Jason86089112",160626,"2","278586112","0000007E0001020076855A1722B02AEBF420A285C693BBEBA7B0AE54A5FBE37BAB697C83340C1CC3E390DE99C6AAE92BC25635C054347CB3BD13423EAE4859BF1293CB200BC8A7E80555B58ED8A25EEB7B5375DF2AA7A3FB6E94F295D0AAA635D4B836E5748446D424CBF5AE0D25D6DE5BE4CA678770914F88C12A9CAAFA94361DF4"));
//      iosCustomerList.add(new Customer("501541454",160611,"17","549229291","0000007F0001020076855A1722B02A0CE520A28537984EDAE0CC72FD0C3879105A042532450BECC09A8ECC99BF14A7D9DBE723837267680DFEE8A7FA9907AAB30FE6AE8561BF1F4A7F0E77EEE4A4282C459D3AEDE0433C0825CE1869C9D914874E66132120D638D8A6D2BCC4CC0FD43AFA064EB59EB50FAB6A6B4FA19442AA20266302"));
      iosCustomerList.add(new Customer("xcsimida",160910,"14","549229291","0000007F0001020076855A1722B02A0CE520A28537984EDA00B54EFD0C1A8E6EB6F77846BA59A171DE8716F95DE919888BE76BBFD6DC802C21112726E9F8F2628B6853859122ED7FE16342DD79B6E5DE7AE1AA40ED180355297BB8F4E94D58E159CDAC63A5BC496636FE12718B4E2C5976287F91FB53E0A9B2B2D46BC8AA92947A6A35"));
//      iosCustomerList.add(new Customer("yiqi21",160911,"11","373132213","0000007F0001020076855A17827227FE3F9095AA3E78B636AA69B7DEE7A5A5A5E702A580C8F0271C37F6F775B150DA0907D4A67396653C3CEA8357578886922CA4354489270E9283A6867301E669107B5B397BB150392B2B8983F07BDA934169256925AE71DFF55D6CDF973C058D724C8BD54C8B6436FEF6CA623B56853A1D533B315C"));
      iosCustomerList.add(new Customer("forever5060",161019,"15","363684207","0000007D0001020076855A179A9545EBC3A57E8537D4E84BE3E30FFD01A1AF44CE3126206C300171359598F878CE18522B57BC9BC34B42B7CC7469BA235B5375195DC9542CE441377E85A21E41CB39269D18C7398CAB39E4080C2471A1FC69FE4747BD083E7F12A1518B50D11B166C00ABD4B28B25FC79546880EA75E594FB88C5"));
      iosCustomerList.add(new Customer("joe908",160926,"8","153152557","0000007E0001020076855A179AF425EBF420A28593EF807A665D659CE5F5486F510E5FAEEDA52941E7758E6C5AFB787BC9689231C4542A8927043D2881ACA45583C8C601EFD6C4EDEABA743CFA313821A189A26F7DED17FA2A7D839B5CB901BFA03FA2FF8E9807C3EEADCF6540FAAFB7BD745F67062F4D0768A083087F3820299F85"));
//      iosCustomerList.add(new Customer("zbx5953606",160628,"10","891639902","0000007E0001020076855A179AF11A9AF4A5A285C04BDA65232A8DE096B808E003023520C1373F7FD2A12A16C6D529C86D74075FE9B66BD2ACA71BC247854AB029D63DBB245A6741CB2E704EBF98CBB1CCE9FC1CDDCEFAFC51BBFD6539E92847A327F7A2CB80A37C661229D2589E2D0F38FA6A7D6AB39E82BD7D7A1D177D20776704"));
//      iosCustomerList.add(new Customer("fb_100000995569735",160701,"2","891639902","0000007F0001020076855A179A3625EBF420FE2293E35CD6A7C6C8384A57DF6DCB048F7EF4630D202D5E07CD00E6A96C0E8C448EA616D3813DACDA4C35ABD89B40F89CE4856DF7E1E1CB376DC2E5F2BD2D11FD0726C317DF218E88A5B660F045B5E8E0424E571C4F7BD8D8A4FBBC08C4DAB36C15496D581D1454A65585AB7D208C5DEF"));
//      iosCustomerList.add(new Customer("lws111111",160620,"17","1318473228","0000007F0001020076855A179AA1250CF4A5A285C0765863ADDAF028FE27405579D3EEF066D8F50D11A85B5AC4929D25CEAB9188A2AEFF5CF19247B389FFD0F60B0AD8AE858AC8F25A1F8023DC1545266E299B901BAD07AAAA5FABB0EE68A60876E9A53EF644D79749881B2B563C5D008043B8641BA0AA0B09886D729FD010200CE417"));
//      iosCustomerList.add(new Customer("henghong",160812,"2","1366332529","0000007E0001020076855A179A363E9AF420BB859393BBEBA7B0AE2880A3886AE553B87A20A2E52A4A90DE2393D14FE8B285689CCCFB51FFD0840BD23A8548A2BF2277202737918BB8408A590801A9B5DA4C21EDE42DF20863547425E91C2ADD0DCD2DC7917F3A0A422A206352659230E75107544C81E0840354BF88794394FEA376"));
      iosCustomerList.add(new Customer("qq6532310",161001,"17","245795286","0000007E0001020076855A17E2F4250CF4A5A285C0765863ADDAF028FEA8A3563E4035B410508F8C77581B75D96AD592E8422188A2AE14FA1C9247B3D06F01F22E29AC41854CA5DA3617239E1DFA1598BBDF0AE6044C8484E066D8D59178C26CF7A1CEF479EF7769047E5913B318E882E1A7CDB2CD942B79AA700188EC192036E8F5"));
      iosCustomerList.add(new Customer("yuzhiboyou",161003,"17","912730740","0000007E0001020076855A1722B025EBF420A28593EF802917B1459CD8B67EC13FE42B4BA27E5DB0C0070E76783858A0689231F0C2D2862716917474B37313C57D2285F3C89ACB5B73E61B1368D0B18387AC1FA05F74C9345CAC67559E286AA275E8112D71AD3FAC82D7D4B42A3C86FE7406144C54C545FFEA5EB59F42F2209298AA"));

    }
    return iosCustomerList;
  }
  
  public Map<String,Server> initIOSServers(){
    
    if(iosServerMap == null){
      iosServerMap = new HashMap<String,Server>(10);
      
      iosServerMap.put("1",new Server("103.10.158.37",8100));
      iosServerMap.put("2",new Server("103.10.158.37",8100));
      iosServerMap.put("4",new Server("103.10.158.37",8100));
      iosServerMap.put("6",new Server("103.10.158.115",8400));
      iosServerMap.put("8",new Server("103.10.158.115",8400));
      iosServerMap.put("10",new Server("103.10.158.115",8400));
      iosServerMap.put("11",new Server("103.10.158.115",8300));
      iosServerMap.put("12",new Server("103.10.158.115",8300));
      iosServerMap.put("13",new Server("",8300));
      iosServerMap.put("14",new Server("103.10.158.115",8300));
      iosServerMap.put("15",new Server("103.10.158.115",8300));
      iosServerMap.put("16",new Server("103.10.158.25",8400));
      iosServerMap.put("17",new Server("103.10.158.87",8100));
      
      
    }
    return iosServerMap;
  }
  
  public void doIOSPeiEn(int index){
    
	boolean isFree = (index >=1000);
	if(index >= 1000){
		index -= 1000;
	}
	List<Customer> customerList = isFree?freeCustomerList:iosCustomerList;
	
    for(int i = 0; i < groupSize; i++){
      int customerIndex = index + i;
      if(customerIndex == (customerList.size() - 1)){
        System.out.println(" customer *****: "+customerIndex);
      }
      
      if(customerIndex < customerList.size()){
        Customer cus = (Customer)customerList.get(customerIndex);
        Server server = (Server)iosServerMap.get(cus.getReginCode());
        if(isFree){
        	doFreePeiEn(server.getIp(),server.getPort(),cus.getLoginStr());
    	}else{
    		doPeiEn(server.getIp(),server.getPort(),cus.getLoginStr());
    	}
        
      }
    }
  }
  
}